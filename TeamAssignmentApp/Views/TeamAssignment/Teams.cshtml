@using Microsoft.AspNetCore.Hosting;
@using System.Collections.Generic;
@model TeamAssignmentApp.Models.TeamAssignment;
@inject IWebHostEnvironment Environment;

@{
    ViewData["Title"] = "Teams";
    var colors = new List<string> { "bg-primary", "bg-success", "bg-info", "bg-warning", "bg-danger" };
    var random = new Random();
    var animalNamesPath = System.IO.Path.Combine(Environment.WebRootPath ?? string.Empty, "animals.txt");
    var animalNames = System.IO.File.ReadAllLines(animalNamesPath);
}

<div class="container mt-4">
    <h2>Teams</h2>
    <div class="row" id="teamsContainer">
        @foreach (var team in Model.Teams)
        {
            var colorClass = colors[random.Next(colors.Count)];
            <div class="col-md-4 mb-4 team-card">
                <div class="card @colorClass text-white">
                    <div class="card-header">
                        <span class="team-name">@team.TeamName</span>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            @foreach (var member in team.Members)
                            {
                                <li class="list-group-item">@member</li>
                            }
                        </ul>
                    </div>
                </div>
            </div>
        }
    </div>
    <button class="btn btn-primary mb-4" onclick="assignRandomTeamNames()">Assign Random Team Names</button>
</div>

@section Scripts {
    <script>
        const teamNames = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(animalNames));

        function assignRandomTeamNames() {
            const teamCards = document.querySelectorAll('.team-card');
            const assignedNames = new Set();
            teamCards.forEach(card => {
                let teamName;
                do {
                    teamName = teamNames[Math.floor(Math.random() * teamNames.length)];
                } while (assignedNames.has(teamName));
                assignedNames.add(teamName);
                card.querySelector('.team-name').textContent = teamName;
            });
        }
    </script>
}
